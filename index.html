<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Logistics LLC | Executive Portal</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --gold: #D4AF37; --dark: #0f0f0f; --card: #1a1a1a; --text: #e0e0e0; }
        body { background-color: var(--dark); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; }
        .header { background: #000; padding: 25px; text-align: center; border-bottom: 2px solid var(--gold); }
        .container { max-width: 900px; margin: auto; padding: 20px; }
        .card { background: var(--card); border-radius: 8px; padding: 20px; margin-bottom: 15px; border: 1px solid #333; }
        .btn { background: var(--gold); color: #000; padding: 15px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; width: 100%; text-transform: uppercase; }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #222; border: 1px solid #444; color: #fff; border-radius: 4px; box-sizing: border-box; }
        
        /* Status Banner */
        .status-banner { padding: 15px; border-radius: 6px; text-align: center; font-weight: 800; margin-bottom: 20px; color: #fff; }
        .bg-red { background-color: #e74c3c; } .bg-green { background-color: #2ecc71; }
        .bg-blue { background-color: #3498db; } .bg-orange { background-color: #f39c12; }

        /* Logistics Routing Style */
        .route-grid { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; text-align: center; margin-bottom: 20px; }
        .route-point { padding: 10px; }
        .route-arrow { color: var(--gold); font-size: 1.5rem; }
        
        .label { color: #888; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; }
        .data { font-size: 1rem; font-weight: 600; margin-top: 5px; }
        .map-frame { width: 100%; height: 350px; border-radius: 8px; border: 1px solid #444; margin-top: 15px; }
        .support-btn { display: block; text-align: center; background: none; border: 1px solid var(--gold); color: var(--gold); padding: 12px; border-radius: 4px; text-decoration: none; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>

<header class="header"><div style="color:var(--gold); font-weight:900; font-size: 1.6rem; letter-spacing: 2px;">GLOBAL LOGISTICS LLC</div></header>

<div class="container">
    <div class="card">
        <input type="text" id="trackingInput" placeholder="Enter Tracking ID">
        <button class="btn" onclick="trackShipment()">Secure Track</button>
    </div>

    <div id="results" style="display:none;">
        <div style="color:var(--gold); text-align:center; margin-bottom:10px; font-size:0.9rem;">
            <i class="fas fa-check-shield"></i> OFFICIAL SHIPMENT PORTAL
        </div>
        
        <div id="status-box" class="status-banner"></div>

        <div class="card">
            <div class="route-grid">
                <div class="route-point">
                    <div class="label">Origin</div>
                    <div class="data" id="res-origin"></div>
                </div>
                <div class="route-arrow"><i class="fas fa-plane"></i></div>
                <div class="route-point">
                    <div class="label">Destination</div>
                    <div class="data" id="res-dest"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div>
                    <div class="label">Registered By (Sender)</div>
                    <div class="data" id="s-name"></div>
                    <div style="font-size:0.8rem; color:#888;" id="s-addr"></div>
                </div>
                <div>
                    <div class="label">Registered To (Recipient)</div>
                    <div class="data" id="r-name"></div>
                    <div style="font-size:0.8rem; color:#888;" id="r-addr"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="label">Current Update Location</div>
            <div class="data" id="res-loc"></div>
            <div class="label" style="margin-top:10px;">Service Type: <span id="res-service" style="color:var(--gold)"></span></div>
            <iframe id="map-frame" class="map-frame" src=""></iframe>
        </div>

        <a id="support-link" href="mailto:trustgloballogisticsllc@gmail.com" class="support-btn">
            <i class="fas fa-headset"></i> CONTACT SUPPORT
        </a>
    </div>
</div>

<script>
    const client = supabase.createClient('https://szegegtenkudltrqpwgt.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6ZWdlZ3Rlbmt1ZGx0cnFwd2d0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwMjUxMTksImV4cCI6MjA4NTYwMTExOX0.nFes3cgEF8QHVs1USV6lcvCR3E7TIAgIEvwA0FEMBZU');

    async function trackShipment() {
        const id = document.getElementById('trackingInput').value.trim();
        const { data, error } = await client.from('shipments').select('*').eq('tracking_number', id).single();
        
        if (error || !data) return alert("Security Error: Tracking Number not found.");

        document.getElementById('results').style.display = 'block';
        
        // Populate Data
        document.getElementById('res-origin').innerText = data.origin_hub;
        document.getElementById('res-dest').innerText = data.destination_hub;
        document.getElementById('res-loc').innerText = data.current_location;
        document.getElementById('res-service').innerText = data.service_type;
        
        document.getElementById('s-name').innerText = data.sender_name;
        document.getElementById('s-addr').innerText = data.sender_full_address;
        document.getElementById('r-name').innerText = data.recipient_name;
        document.getElementById('r-addr').innerText = data.recipient_full_address;

        // Status Colors
        const sb = document.getElementById('status-box');
        sb.innerText = data.status;
        sb.className = 'status-banner ' + (
            data.status === 'HELD IN CUSTOMS' || data.status === 'RETURNED TO SENDER' ? 'bg-red' : 
            data.status === 'DELIVERED' ? 'bg-green' : 
            data.status === 'IN TRANSIT' ? 'bg-blue' : 'bg-orange'
        );

        // Support Mail
        document.getElementById('support-link').href = `mailto:trustgloballogisticsllc@gmail.com?subject=Support: ${data.tracking_number}`;

        // Map Logic (Stays in portal)
        document.getElementById('map-frame').src = `https://maps.google.com/maps?q=${encodeURIComponent(data.current_location)}&t=&z=13&ie=UTF8&iwloc=&output=embed`;
    }
</script>
</body>
</html>
